% This is a simple ode integrator for the Noble Purkinje fibe model equations% it is set up to be easily modified to use for other dynamicsclose allclear allclc %The natural period is about 800'global gnabar Vna gan Van Vk cm  Inpgnabar = 400.;Vna = 40.;gan = 0.14;Van = 40.;Vk = -100.;cm = 12.;	  tstep = 2;t_end = 3500;% specify initial data:Inp = 0; %.8;V = -49;m=0.1;h = 0.7;n = 0.3;%specify the output pointstspan = [0:tstep:t_end];s0 = [V;m;h;n];[T,S] = ode23(@NobledeRHS,tspan, s0, odeset('maxstep',1));  V = S(:,1);m = S(:,2);h = S(:,3);n = S(:,4);figure(1)subplot(2,1,1)plot(T,V,'linewidth',2)xlabel('t (ms)','fontsize',20)ylabel('V (mV)','fontsize',20)subplot(2,1,2)plot(T,m,'r',T,h,'b',T,n,'g','linewidth',2)legend('m','h','n','fontsize',16)xlabel('t (ms)','fontsize',20)for j = 1:length(T)    s = S(j,:);    currents = IV(s);    INa(j) = currents(1);    IK(j) = currents(2);    Icl(j) = currents(3);endfigure(3)plot(T,INa,T,IK,T,Icl,'linewidth',2)legend('INa','IK','Il','fontsize',16)xlabel('t (ms)','fontsize',20) %%%the right hand side for ode simulation:function s_prime=NobledeRHS(t,s)global gnabar Vna gan Van Vk cm InpV = s(1);m = s(2);n = s(4);h = s(3);      am = -0.1*(V+48.)/(exp(-(V+48.)/15.)-1.);      bm = 0.12*(V+8.)/(exp((V+8.)/5.)-1.);      an = -0.0001*(V+50.)/(exp(-(V+50.)/10.)-1.);      bn = 0.002* exp(-(V+90.)/80.);      ah = 0.17*exp(-(V+90.)/20.);      bh = 1./(1.+exp(-(V+42.)/10.));     currents = IV(s);     INa = currents(1);     IK = currents(2);     Ian = currents(3);           Fv = -(INa+IK+Ian +Inp)/cm;      Fm = am*(1.-m)-bm*m;      Fh = ah*(1.-h)-bh*h;      Fn = an*(1.-n)-bn*n;s_prime = [Fv Fm Fh Fn]';end%%function currents=IV(s)global gnabar Vna gan Van Vk cm InpV = s(1);m = s(2);n = s(4);h = s(3); gna = gnabar*m.^3*h ;      gk1 = 1.2*exp(-(V+90.)/50.) + 0.015*exp((V+90.)/60.);      gk2 = 1.2*n.^4;      INa = gna*(V-Vna);      Ik = (gk1+gk2)*(V-Vk);      Ian = gan*(V-Van);currents = [INa, Ik, Ian];end