%  -------------------------------------------------------------------%%   This code sets n and h to be constant and looks at the nullclines in%   the fast Hodgkin-Huxley model%%   For Chapter 5, Fig. 5.8 of%   Keener and Sneyd, Mathematical Physiology, 3rd Edition, Springer.% %   Written by James Keener and James Sneyd% %  ------------------------------------------------------------------- clear allclose allclcset(0,                           ...   'defaultaxesfontsize', 20,   ...   'defaultaxeslinewidth', 1.0, ...   'defaultlinelinewidth', 2.0);formatSpecF = '%6.2f\n';p.Veq = 0; %is the original HH formulation%p.Veq = -65; % is the physiological formulationTfact = 1; % this is the correction factor for temperatures other that 6.3C%Tfact = 0.977 % correspnds to 0C%Tfact = 1.085 % corresponds to 30 C.p.gnabar = 120.;p.gkbar = 36;p.gl = 0.3; Vna0 = 115;Vk0 = -12;Vl0 = 10.5988;p.Vna = Tfact*(Vna0+p.Veq) - p.Veq;p.Vk = Tfact*(Vk0+p.Veq)-p.Veq;p.Vl = Tfact*(Vl0+p.Veq)-p.Veq;p.Inp = 0;  % this is the amplitude of the initial input stimulus% p.Inp = 3.47;  % this is the amplitude of the initial input stimulus %Iapp   is the amplitude of the steady current stimulusp.Iapp = 0;  % pick p.Iapp <0 to make things easier to seep.BCL = 39;p.BCL = 0;%  assign initial dataV = p.Veq;m = 0.0529;h0set=[0.5961,0.4,0.2,0.1];n0set = [0.3177,0.5,0.7,0.8];for j=1:length(n0set)    n0=n0set(j);    h0=h0set(j);        % start by plotting nullclines    Vm = [-20:0.1:120];    AM=.1*(25.-Vm)./(exp(.1*(25.-Vm))-1.);    BM=4.*exp(-Vm/18);        Minf=AM./(AM+BM);        M=[0:.001:1];    gk=p.gkbar*n0.^4;    gna=p.gnabar*M.^3.*h0;        Vs= (gna.*p.Vna +gk.*p.Vk +p.gl*p.Vl + p.Iapp)./(gna+gk+p.gl);    %Vs =(p.Iapp+gna*p.Vna +gk*p.Vk +p.gl*p.Vl)./(gna+gk+p.gl);         %this is the dv/dt=0 curve    figure(1)    plot(Vm,Minf,'b',Vs,M,'g')    xlabel('V')    ylabel('m')    axis([-10 120 0 1])     title(strcat('I_{app} = ',sprintf(formatSpecF,p.Iapp)),'fontsize',18)    hold onendhold off