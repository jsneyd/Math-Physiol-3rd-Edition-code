%  -------------------------------------------------------------------%%   Symbolic computations for a five-compartment model of the circulatory%   system.%%   For Chapter 11, Section 11.5.2 of%   Keener and Sneyd, Mathematical Physiology, 3rd Edition, Springer.% %   Written by James Keener and James Sneyd.% %  ------------------------------------------------------------------- clear allclose allclcsyms QQ P_sa P_sv P_s P_pa P_pv V_sa V_sv V_p syms F C_ld C_rd C_sa C_sv C_p R_sa R_sv R_p V_t V_0p V_0s% systemic arteriesfun0 = QQ - (P_sa - P_s)/R_sa;fun1 = QQ - F*C_ld*P_pv;fun2 = V_sa - V_0s - C_sa*(P_sa + P_s)/2;% systemic veinsfun3 = QQ - (P_s-P_sv)/R_sv;fun4 = V_sv - C_sv*(P_sv+P_s)/2;% pulmonary systemfun4a = QQ - (P_pa - P_pv)/R_p;fun5 = QQ - F*C_rd*P_sv;fun6 = V_p - V_0p - C_p*(P_pa+P_pv)/2;% volumefun7 = V_t - V_sa - V_sv - V_p;eqns = [fun0==0,fun1==0,fun2==0,fun3==0,fun4==0,fun4a==0,fun5==0,fun6==0,fun7==0];vars = [P_sa,P_sv,P_s,P_pa,P_pv,V_sa,V_sv,V_p,QQ];sols = solve(eqns,vars);QQ = simplify(sols.QQ,150);Qinf = simplify(limit(QQ,F,Inf),150);pretty(Qinf)