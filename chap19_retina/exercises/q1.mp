{VERSION 2 3 "APPLE_PPC_MAC" "2.3" }{USTYLETAB {CSTYLE "Maple Input" -1 0 "Monaco" 1 12 0 0 0 1 0 0 0 0 1 0 0 0 0 }{CSTYLE "2D Math" -1 2 "Times" 0 1 0 0 0 0 0 0 2 0 0 0 0 0 0 }{CSTYLE "2D Output" 2 20 "" 0 1 0 0 255 1 0 0 0 0 0 0 0 0 0 }{PSTYLE "Normal" -1 0 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }0 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Text Output" -1 2 1 {CSTYLE "" -1 -1 "Courier" 1 10 0 0 255 1 0 0 0 0 0 1 3 0 0 }1 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "" 2 6 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 2 0 0 }0 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Warning" 2 7 1 {CSTYLE "" -1 -1 "" 0 1 0 0 255 1 0 0 0 0 0 0 1 0 0 }0 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Error" 7 8 1 {CSTYLE "" -1 -1 "" 0 1 255 0 255 1 0 0 0 0 0 0 0 0 0 }0 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Maple Output" 0 11 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }3 3 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "" 11 12 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }1 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Maple Plot" 0 13 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }3 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }}{SECT 0 {EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 488 "\nreadlib('unassign'):\nunassign('s1','s2','E','Vstar','tauy','k1','gam','delta','kappa',\n      'eta','tau1','taum','tauz','g','x','y','z','I0','p0','x0','y0',\n      'z0','V0','V'):\n\n#s1:=1.59:  s2:=1130:  E:=-13:  Vstar:=35.7:\n#tauy:=0.07: k1:=35.4: gam:=303: delta:=5: kappa:=0.1:\n#eta:=52.5: tau1:=0.012: taum:=0.016: tauz:=0.04:\n\nV0:=E*(1-y0):\nI0:=(exp(-V0/s1) - 1)/s2:\nx0:=(y0*exp(V0/Vstar))^(1/3):\np0:=eta*I0/(k1+eta*I0):\ng := x0*(delta + (gam-delta)*p0);\n\nA:= 4+ 84/(1+(y0/0.34)^4):\n" }}{PARA 6 "" 1 "" {TEXT -1 118 "g := (y0*exp(E*(1-y0)/Vstar))^(1/3)*(delta+(gam-delta)*eta*(exp(-E*(1-y0)/s1)-1)/s2/(k1+eta*(exp(-E*(1-y0)/s1)-1)/s2))" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 23 "\nplot(\{g,A\},y0=0.1..1);" }}{PARA 13 "" 1 "" {INLPLOT "6&-%'CURVESG6$7S7$$\"1+++++++5!#;$\"12WVU%3wt)!#97$$\"1++](Quh>\"F*$\"1VbNGFDt')F-7$$\"1+]7tY'oO\"F*$\"1&*)HUqqhe)F-7$$\"1++D^P#)e:F*$\"1?1=GMbW%)F-7$$\"1++ve_0_<F*$\"1**=%*GxpY#)F-7$$\"1+]iq$oV%>F*$\"1ou&*)o)Q))zF-7$$\"1+]7VsmA@F*$\"1Y[S&fz@p(F-7$$\"1+]7)R&G2BF*$\"1$z$=iQEItF-7$$\"1+]7ex@)\\#F*$\"14!*p'zwT!pF-7$$\"1+]i&zP&)o#F*$\"1aY=2)H*QkF-7$$\"1++]Z`I%)GF*$\"1WU\")yn%R$fF-7$$\"1++v8vtcIF*$\"1lDU'*ys![&F-7$$\"1++]#Hb3D$F*$\"1'=#HmOzv\\F-7$$\"1++]P,xXMF*$\"1q*Q+(>q([%F-7$$\"1++]2ngLOF*$\"1DE*Go!3XSF-7$$\"1+]73.=/QF*$\"1G6Mtw-sOF-7$$\"1++]<)3q+%F*$\"1#fN#)=GxE$F-7$$\"1+++q6$)yTF*$\"1@!o!)=k%fHF-7$$\"1+]789qyVF*$\"1<`1<r\\REF-7$$\"1*****\\W?cb%F*$\"1gCttx0*Q#F-7$$\"1+]7j'G(\\ZF*$\"1GRbh())o9#F-7$$\"1,]P*elX$\\F*$\"1%\\#f@p*\\%>F-7$$\"1++DJNUF^F*$\"1Qd:(yD4w\"F-7$$\"1+]iDt_/`F*$\"1:>sLw.8;F-7$$\"1***\\Ppdb\\&F*$\"1EgI?/Ut9F-7$$\"1**\\7eX)Rp&F*$\"1g;n3$[uM\"F-7$$\"1**\\(os:n'eF*$\"1/o7a-_^7F-7$$\"1++D@,F`gF*$\"1A;^iWPg6F-7$$\"1+++l!**fC'F*$\"1D,tT;,y5F-7$$\"1++DOnaMkF*$\"1-HNEnY25F-7$$\"1+]7.j(ph'F*$\"1[9pJa$QZ*!#:7$$\"1***\\PBL&>oF*$\"1Jv]!G(3))))F^u7$$\"1*****\\kR:+(F*$\"11(e4jY]U)F^u7$$\"1++]P.(e>(F*$\"1NpwGa%y)zF^u7$$\"1**\\7GG'>P(F*$\"1A-1Sl;OwF^u7$$\"1++]K%yWc(F*$\"1Ks0'RoQH(F^u7$$\"1**\\781iXxF*$\"1<)p*>B.2qF^u7$$\"1+]i&Qm\\$zF*$\"1pIZt^:RnF^u7$$\"1****\\(['3?\")F*$\"11f5%>z\\]'F^u7$$\"1**\\7y+*QJ)F*$\"1:T&>D%e&G'F^u7$$\"1+++qfa+&)F*$\"1h#*H!p)>'4'F^u7$$\"1++vy&G9p)F*$\"1\"fX+Y0@#fF^u7$$\"1,]7$eI2)))F*$\"1\\'\\#*3Bnw&F^u7$$\"1+++l%zY0*F*$\"1jtvY[RPcF^u7$$\"1***\\P^WSD*F*$\"14r&4'GB.bF^u7$$\"1*******)*eBV*F*$\"1^8O+%yXR&F^u7$$\"1+]78%zCi*F*$\"1*)))R[\"G#*G&F^u7$$\"1**\\(o\"*[W!)*F*$\"1]dd5^Z(>&F^u7$$\"\"\"\"\"!$\"1$[SkQ>x5&F^u-%'COLOURG6&%$RGBG$\"#5!\"\"FgzFgz-F$6$7X7$F($\"1\\&HS!38a&)F-7$$\"1+](ofV!\\5F*$\"14(\\ISR[e)F-7$$\"1++v$>(3)4\"F*$\"1a\"\\]O'R1')F-7$$\"1+]i!zIr9\"F*$\"1p&Ru8Y#>')F-7$F/$\"1745wlzB')F-7$$\"1+DJI&>:G\"F*$\"1zt#>#o.8')F-7$F4$\"1,G?)o)4!e)F-7$$\"1+v=7U%GY\"F*$\"12Bsg#='=&)F-7$F9$\"1&HM!>HOL%)F-7$F>$\"1bL$*e!Gy>)F-7$FC$\"1!HNeV'[\"*yF-7$FH$\"1d,&yW[hb(F-7$FM$\"1,]]I_2prF-7$FR$\"1?8\"zj\\%QnF-7$FW$\"1B6'*G1S!H'F-7$Ffn$\"1F)Q&e;N@eF-7$F[o$\"1Gpnvy\\4aF-7$F`o$\"1\"\\5%p^2b\\F-7$Feo$\"1%)z!4BL`^%F-7$Fjo$\"1L$HX^#H7TF-7$F_p$\"1[HBa)))ow$F-7$Fdp$\"17KF^$*4%Q$F-7$Fip$\"1>g)f^YY3$F-7$F^q$\"1;_$oYK`w#F-7$Fcq$\"1+7ei#*R3DF-7$Fhq$\"1i7??jO`AF-7$F]r$\"14Y6X!)QN?F-7$Fbr$\"1o_#=N0A$=F-7$Fgr$\"1*p())=\"))em\"F-7$F\\s$\"1*4U'zT\\1:F-7$Fas$\"1i)pT)o&4O\"F-7$Ffs$\"1VM(oK7$\\7F-7$F[t$\"1eff&)f!H9\"F-7$F`t$\"1&H8@/_o/\"F-7$Fet$\"1-&*\\gOP]'*F^u7$Fjt$\"1>kE0*3/'*)F^u7$F`u$\"1O6mA/y(H)F^u7$Feu$\"1%RZ=,*G%y(F^u7$Fju$\"1O2OH@76tF^u7$F_v$\"1E$3pqd8%pF^u7$Fdv$\"15QvH&)R$f'F^u7$Fiv$\"1zrOkw:8jF^u7$F^w$\"1nI)e)4'H1'F^u7$Fcw$\"1G([5F!HbeF^u7$Fhw$\"1J0`)\\o>n&F^u7$F]x$\"1g!*f`86CbF^u7$Fbx$\"1g/17k?)R&F^u7$Fgx$\"1NNxWjH&H&F^u7$F\\y$\"1s7K&)[^<_F^u7$Fay$\"1Q&\\*ea`X^F^u7$Ffy$\"1hx:@Un%4&F^u7$F[z$\"1D,Gc=i_]F^u7$F`z$\"1vg'4>0E-&F^u7$Fez$\"\"&Fgz-F[[l6&F][lFgzF^[lFgz-%+AXESLABELSG6$%#y0G%!G-%%VIEWG6$;$FfzF`[lFez%(DEFAULTG" 2 265 265 265 2 0 1 0 2 9 0 4 2 1.000000 45.000000 45.000000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 298 "\n# Output the curves to a file\nnum := 101:\ndy := 0.01:\nA:= array(1..num+1,1..2):\nB:= array(1..num+1,1..2):\n\nfor i from 1 to 2 do\n    dumy := (i-1)*dy:\n    A[i,1]:=dumy: B[i,1]:=dumy:\n    A[i,2]:=g(dumy):\n    A[i,2]:=A(dumy):\nod:\n\nfd:=fopen(testfile,WRITE,TEXT):\nwritedata(fd,A):\nfclose(testfile):\n\n" }}{PARA 8 "" 1 "" {TEXT -1 87 "Error, (in writedata) Bad data found, array(1 .. 102, 1 .. 2,[(1, 2)=g(0)(0),(1, 1)=0])" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 1801 "\nwith(plots):\nreadlib('unassign'):\nunassign('s1','s2','E','Vstar','tauy','k1','gam','delta','kappa',\n    \+  'eta','tau1','taum','tauz','g','x','y','z','I0','p0','x0','y0',\n   \+   'z0','V0','V','t','pfun','xfun','gfun','yfun','zfun','Vfun',\n     \+ 'input','kern','sols'):\n\ns1:=1.59:  s2:=1130:  E:=-13:  Vstar:=35.7:\ntauy:=0.07: k1:=35.4: gam:=303: delta:=5: kappa:=0.1:\neta:=52.5: tau1:=0.012: taum:=0.016: tauz:=0.04:\n\nI0 := 0.05:\n\n# First find the steady state for each I0\nV0:=-s1*ln(1+s2*I0):\np0:=eta*I0/(k1+eta*I0):\ny0:=1-V0/E:\nx0:=(y0*exp(V0/Vstar))^(1/3):\nz0:=y0:\n\n#  A cheating way of getting g(y) without having to write it all out \n#  explicitly.\n#dumV:=E*(1-y(t)):\n#dumI:=(exp(-dumV/s1) - 1)/s2:\n#dumx:=(y(t)*exp(dumV/Vstar))^(1/3):\n#dump:=eta*dumI/(k1+eta*dumI):\n#gfun := dumx*(delta + (gam-delta)*dump):;\n\n#gfun := t-> #(y(t)*exp(E*(1-y(t))/Vstar))^(1/3)*(delta+(gam-delta)*eta*(exp(-E*(1-y(t)#)/s1)-1)/s2/(k1+eta*(exp(-E*(1-y(t))/s1)-1)/s2));\n\nkern:=(eta/tau1/6)*((t/tau1)^3)*exp(-t/tau1):\ninput := eta*I0 + I0*kern:\npfun:= input*(1-p(t)) - k1*p(t):\nxfun:= (y(t)*exp(E*(1-y(t))/Vstar))^(1/3)*(delta+(gam-delta)*eta*(exp(-E*(1-y(t))/s1)-1)/s2/(k1+eta*(exp(-E*(1-y(t))/s1)-1)/s2)) - (gam-delta)*x(t)*p(t) - delta*x(t);\nyfun:= (x(t)^3)*exp(-V(t)/Vstar) - y(t):\nzfun:= ((1-kappa)/(1+kappa))*(x(t)^3)*exp(-V(t)/Vstar) +         \+               (2*kappa/(1+kappa))*y(t) - z(t):\nVfun := (-6*E/(4+kappa))*(x(t)^3)*exp(-V(t)/Vstar) +                     (2*(1+kappa)/(4+kappa))*E*z(t) - (V(t)-E) - \n        (3*E*kappa/(4+kappa))*y(t):\n\nsols := dsolve(\n\{diff(p(t),t)=pfun,\ndiff(x(t),t)=xfun,\ndiff(y(t),t)=yfun/tauy,\ndiff(z(t),t)=zfun/tauz,\ndiff(V(t),t)=Vfun/taum,\np(0)=p0,x(0)=x0,y(0)=y0,z(0)=z0,V(0)=V0\},\n\{p(t),x(t),y(t),z(t),V(t)\},\ntype=numeric, output=listprocedure);\n\nodeplot(sols,[t,V(t)],0..0.5);" }}{PARA 0 "> " 0 "" {MPLTEXT 1 0 0 "" }}{PARA 12 "" 1 "" {XPPMATH 20 "6#>%%xfunG,(*&*&-%\"yG6#%\"tG\"\"\"-%$expG6#,&$!+$ec9k$!#5F,F($\"+$ec9k$F3F,#F,\"\"$,&\"\"&F,*&,&-F.6#,&$\"+H15w\")!\"*F,F($!+H15w\")FAF,!\"\"F,F,,&$\"+#)RNNN!\")F,F<$\"+*p<gk%!#6FD$\"+uK^%Q\"FHF,F,*&-%\"xGF*F,-%\"pGF*F,!$)HFO!\"&" }}{PARA 8 "" 1 "" {TEXT -1 82 "Error, (in DEtools/convertsys) unable to convert to an explicit first-order system" }}{PARA 8 "" 1 "" {TEXT -1 45 "Plotting error, non-numeric vertex definition" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 1134 " \nreadlib('unassign'):\nunassign('s1','s2','E','Vstar','tauy','k1','gam','delta','kappa',\n      'eta','tau1','taum','tauz','g','x','y','z','I0','p0','x0','y0',\n      'z0','V0','V','t','pfun','xfun','gfun','yfun','zfun','Vfun',\n      'input','kern','sols','x1','y1','z1','V1','p1'):\n\n# Finding V1\np:= p0 + epsilon*p1:\nx:= x0 + epsilon*x1:\ny:= y0 + epsilon*y1:\nz:= z0 + epsilon*z1:\nV:= V0 + epsilon*V1:\n\ntheta:=exp(-V0/Vstar)*(1-V1*epsilon/Vstar):\ninput:=I0*eta + epsilon*H:\npfun:= input*(1-p) \+- k1*p:\nxfun:= g0+epsilon*gprime - (gam-delta)*x*p - delta*x:\nyfun:= (x^3)*theta - y:\nzfun:= ((1-kappa)/(1+kappa))*(x^3)*theta+(2*kappa/(1+kappa))*y - z:\nVfun := (-6*E/(4+kappa))*(x^3)*theta + (2*(1+kappa)/(4+kappa))*E*z - (V-E) - (3*E*kappa/(4+kappa))*y:\n\n\np1fun:= coeff(collect(pfun,epsilon),epsilon,1):\nx1fun:= coeff(collect(xfun,epsilon),epsilon,1):\ny1fun:= coeff(collect(yfun,epsilon),epsilon,1):\nz1fun:= \+coeff(collect(zfun,epsilon),epsilon,1):\nV1fun:= coeff(collect(Vfun,epsilon),epsilon,1):\n\nsolve(p1fun=0,p1);\nsolve(x1fun=0,x1);\nsols:=solve(\{y1fun=0,z1fun=0,V1fun=0\},\{y1,z1,V1\}):\nassign(sols):\nsimplify(y1);\nsimplify(z1);\nsimplify(V1);" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#,$*(%\"HG\"\"\",&!\"\"F&%#p0GF&F&,&*&%#I0GF&%$etaGF&F&%#k1GF&F(F(" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#,$*&,(*(%#x0G\"\"\"%#p1GF(%$gamGF(!\"\"*(F'F(F)F(%&deltaGF(F(%'gprimeGF(F(,(*&%#p0GF(F*F(F+*&F1F(F-F(F(F-F+F+F+" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#,$*,%#x0G\"\"#-%$expG6#,$*&%#V0G\"\"\"%&VstarG!\"\"F/F-%#x1GF-F.F-,&*(%\"EGF-F%\"\"$F'F-F-F.F/F/!\"$" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#,$*,%#x0G\"\"#-%$expG6#,$*&%#V0G\"\"\"%&VstarG!\"\"F/F-%#x1GF-F.F-,&*(%\"EGF-F%\"\"$F'F-F-F.F/F/!\"$" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#,$*.%\"EG\"\"\"%#x0G\"\"#%#x1GF&-%$expG6#,$*&%#V0GF&%&VstarG!\"\"F1F&F0F&,&*(F%F&F'\"\"$F*F&F&F0F1F1F4" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 0 "" }}}}{MARK "4 0 0" 748 }{VIEWOPTS 1 1 0 1 1 1803 }