%the purpose of this file is to find the escape time from a quadratic potential%using exact formulasclear;global a F N = 50;tstep = 1/N;s0 = zeros(2*(N+1),1);%Problem #1:  Escape from a quadratic wella = [0:N]';F = 0;tspan = [-1:tstep:1];[X,AW] = ode23('deRHS1',tspan, s0);  Exit_time =  AW(N+1,1:N+1)-AW(2*N+1,1:N+1);%Exit_time =  AW(1,1:N+1)-AW(N+1,1:N+1);est_off = 1/Exit_time(50)*exp(-a)/exp(-50);koff = 1./Exit_time;asym_large_a = 2*exp(-a).*a.^(3/2)/sqrt(pi);figure(1)semilogy(a,1./Exit_time,'b',a,est_off,'r--',a,asym_large_a,'g--','linewidth',2);%a,asym_large_a,'g--'%title('Off-Rate for a quadratic potential ','fontsize',14)xlabel('\Delta G/kT','fontsize',16)ylabel('k_{off}','fontsize',16)figure(2)%plot(a,koff./est_off',)semilogy(a,asym_large_a./koff',a,est_off./koff','--')title('Ratio asymptotic/exact off-rates')%Problem #2: Escape from a forced quadratic potentialk=5;for j= 1:ka=j*N/kdF = 2;F=dF*[0:N]';tspan = [-1:tstep:1];[X,BW] = ode23('deRHS1',tspan, s0);  Escape_time = diag(AW,-N)-AW(2*N+1,1:N+1)';Escape_center = BW(N+1,1:N+1)-BW(2*N+1,1:N+1);Fg = 2*[2:N];Asym = 1./Fg + a.*(Fg-2)./Fg.^3; %The asymptotic formulaOff_rate = 1./Escape_center;F0 = log(Off_rate(2)/Off_rate(1))/dF;Off_est = Off_rate(1)*exp(F/F0);asym_large_af = 2*exp(-a.*(1-F./(2*a)).^2).*sqrt(a).*(a-F/2)/sqrt(pi);figure(3)semilogy(F,Off_rate,'b',F,Off_est,'r--',F, asym_large_af,'g--','linewidth',2)%,Fg,1./Asym,'r')%plot(F,Off_rate,'b','linewidth',2)%F,Off_est,'r--',)%,Fg,1./Asym,'r')%title('Off-Rate from a forced quadratic potential','fontsize',16)xlabel('{FL/kT}','fontsize',16)ylabel('k_{off}','fontsize',16)hold onendhold offaxis([0 100 0 100])