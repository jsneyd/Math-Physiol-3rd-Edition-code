{VERSION 2 3 "APPLE_PPC_MAC" "2.3" }{USTYLETAB {CSTYLE "Maple Input" -1 0 "Monaco" 1 12 0 0 0 1 0 0 0 0 1 0 0 0 0 }{CSTYLE "2D Math" -1 2 "Times" 0 1 0 0 0 0 0 0 2 0 0 0 0 0 0 }{CSTYLE "2D Output" 2 20 "" 0 1 0 0 255 1 0 0 0 0 0 0 0 0 0 }{PSTYLE "Normal" -1 0 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }0 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Maple Output" 0 11 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }3 3 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }{PSTYLE "Maple Plot" 0 13 1 {CSTYLE "" -1 -1 "" 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 }3 0 0 -1 -1 -1 0 0 0 0 0 0 -1 0 }}{SECT 0 {EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 117 "\nfun1 := f*(1-n0-nm1) - g*n0 :\nfun2 := fm*(1-n0-nm1) - gm*nm1:\n\nsols :=solve(\{fun1=0,fun2=0\},\{n0,nm1\});\nassign(sols);" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#>%%solsG<$/%#n0G*(%#gmG\"\"\"%\"fGF*,(*&%#fmGF*%\"gGF*F**&F)F*F+F*F**&F)F*F/F*F*!\"\"/%$nm1G*(F.F*F/F*F,F2" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 593 "readlib('unassign'):\nunassign('f','g','fm','gm','x'):\nunassign('f1','g1','g2','h','Delta','rho','k'):\n\nf1:=0.25: g1:=0.25: g2:=2: h:=1: Delta:=0.1: rho:=1: k:=1:\nv:=2.0:\nf := f1*x/h: fm \+:= f1*(x-Delta)/h:\ng:=g1*x/h: gm := g1*(x-Delta)/h:\nn0low := f/(g + \+f):\nn0high := f/( fm*g/gm + f + g):\nnm1low := fm/( f*gm/g + fm+gm):\nnm1high := fm/(fm+gm):\nn0int := int(x*n0low,x=0..Delta) + int(x*n0high,x=Delta..h):\nsimplify(n0int);\nnm1int := int((x-Delta)*nm1low,x=Delta..h) +              int((x-Delta)*nm1high,x=h..h+Delta):\nsimplify(nm1int);\ndum1:=simplify(n0int+nm1int);\ndum2:=int(x*n0low,x=0..h);\n" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#$\"++++v;!#5" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#$\"++++D=!#5" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#>%%dum1G$\"+++++N!#5" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#>%%dum2G$\"+++++D!#5" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 20 "simplify(dum1-dum2);" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#,$*,%\"hG\"\"\"%#f1GF&,&*&F%F&%#g1GF&F&*&%&DeltaGF&F'F&\"\"#F&,&F*F&F'F&!\"\",&F'F-F*F&F/#F&F-" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 1159 "\n# The numerical solutions\n\nwith(plots):\nreadlib('unassign'):\nunassign('f','g','n0','nm1','x','r'):\nunassign('f1','g1','g2','h','Delta','rho','k'):\n\nf1:=0.25: g1:=0.25: g2:=2: h:=1: Delta:=0.1: rho:=1: k:=1:\nv:=0.2:\n\nf := x -> (f1*x/h)*(Heaviside(x)-Heaviside(x-h)):\ng := x -> g2*Heaviside(-x) + (g1*x/h)*Heaviside(x):\n\ndum := dsolve(\n    \{-diff(n0(y),y) =f(v*y)*(1-n0(y)-nm1(y)) - g(v*y)*n0(y),\n     -diff(nm1(y),y)=f(v*y-Delta)*(1-n0(y)-nm1(y)) -                                               g(v*y-Delta)*nm1(y),\n      n0((h+Delta)/v)=0,nm1((h+Delta)/v)=0\},\n    \{n0(y),nm1(y)\},type=numeric,method=gear, output=listprocedure\n      ):\nfn0 := subs(dum,n0(y)):\nfnm1 := subs(dum,nm1(y)):\nodeplot(dum,[[y,n0(y)],[y,nm1(y)]],-2/v..1.5/v);\n\n\n# Integrate the curves to get the force for each v.\n#num := 100:\n#dx := 0.05:\n#sumn0 := h*fn0(h)/2:\n#sumnm1 := h*fnm1(h+Delta)/2:\n#for i from 1 to num do\n#      sumn0 := sumn0 + (h-i*dx)*fn0(h-i*dx):\n#      sumnm1 := sumnm1 + (h-i*dx)*fnm1(h+Delta-i*dx):\n#od:\n#sumn0 := dx*(sumn0 + (h-(num+1)*dx)*fn0(h-(num+1)*dx)/2):\n#sumnm1 := dx*(sumnm1 + (h-(num+1)*dx)*fnm1(h+Delta-(num+1)*dx)/2):\n#\n#force := rho*k*(sumn0 + sumnm1);" }}{PARA 13 "" 1 "" {INLPLOT "6$-%'CURVESG6$7T7$$!+++++5!\")$\"1SQy]'R*o'*!#D7$$!+Vr&Gk*!\"*$\"1VZCH64v>!#C7$$!+'G9dG*F1$\"16G1AIbMSF47$$!+H9dG*)F1$\"1QX<r;XT#)F47$$!+s&G9d)F1$\"1@RSvc\\$o\"!#B7$$!+:dG9#)F1$\"1]&*)Q\"f!*QMFD7$$!+eG9dyF1$\"1y&4t&HrCqFD7$$!+,+++vF1$\"1v>%3M]\\V\"!#A7$$!+Wr&G9(F1$\"1'3lN.)>JHFT7$$!+(G9dy'F1$\"1C2dM#4w)fFT7$$!+I9dGkF1$\"17Z`e$*4B7!#@7$$!+t&G92'F1$\"1j,=XjW)\\#F^o7$$!+;dG9dF1$\"1wMcH)>O5&F^o7$$!+fG9d`F1$\"1=TP/`_U5!#?7$$!+-+++]F1$\"1\\.B#e%eH@F^p7$$!+Xr&Gk%F1$\"1IQ6([R,N%F^p7$$!+)G9dG%F1$\"1B0YNc5')))F^p7$$!+J9dGRF1$\"16[di-=:=!#>7$$!+u&G9d$F1$\"1ypIMx\"zq$Fcq7$$!+<dG9KF1$\"1TJ*QnjUd(Fcq7$$!+gG9dGF1$\"1-`/#H:sa\"!#=7$$!+.+++DF1$\"1Q`k`%Q0;$Fcr7$$!+Yr&G9#F1$\"1+$=uB<hX'Fcr7$$!+*G9dy\"F1$\"1#=V.]3)=8!#<7$$!+K9dG9F1$\"1et3Be'Rp#Fcs7$$!+v&G92\"F1$\"1@b-6p..bFcs7$$!+yr&G9(!#5$\"1$e*oY-7C6!#;7$$!+1'G9d$Fat$\"1<\"*pd3F'H#Fdt7$$!#MFat$\"11U^TYl!p%Fdt7$$\"+Q&G9d$Fat$\"1S_%QEP()p%Fdt7$%%FAILGFeuFduFduFduFduFduFdu7$$\"+5dG9KF1$\"14(\\$[&z$f?Fdt7$$\"+n&G9d$F1$\"19!RhqjZ%=Fdt7$$\"+C9dGRF1$\"1k!)Qfi`i:Fdt7$$\"+\"G9dG%F1$\"10[n16z(=\"Fdt7$$\"+Qr&Gk%F1$\"1\"R.K-f^%oFcs7$$\"+&*******\\F1$\"1FT]?=;/:FT7$$\"+_G9d`F1$!1!y&y\"f'eXfF\\u7$$\"+4dG9dF1$\"1zc#\\-\">x5!#L7$$\"+m&G92'F1$\"12dW*eQE:*F\\u7$$\"+B9dGkF1$!1a2QP5`vFF\\u7$$\"+!G9dy'F1$\"1*=&z$zZy;#F^x7$$\"+Pr&G9(F1$!1E$)=NHzZ7F^x7$$\"+%******\\(F1$\"13%Q5DLJ?#F^x-%'COLOURG6&%$RGBG$\"#5!\"\"\"\"!F_z-F$6$7T7$F($\"1SGxUuatRF-7$F/$\"1^Oo7X$o6)F-7$F6$\"1R(o:\"*R!e;F47$F;$\"1\"y)4#)p!pQ$F47$F@$\"1csSMQ\\=pF47$FF$\"1=WvvFD89FD7$FK$\"1K(f(Rg(o)GFD7$FP$\"1vB\\E>2(*eFD7$FV$\"1)=_]90Y?\"FT7$Fen$\"1xgW$*ymgCFT7$Fjn$\"1c3vG\"\\k-&FT7$F`o$\"1j&>5^hn-\"F^o7$Feo$\"1b*3sg$Q(4#F^o7$Fjo$\"14m/&*>O%G%F^o7$F`p$\"1HVp23u^()F^o7$Fep$\"1mHPDLt(y\"F^p7$Fjp$\"1))3_vR$=l$F^p7$F_q$\"1*4uV\"[mfuF^p7$Feq$\"1/8ete!Q_\"Fcq7$Fjq$\"1DyY-%>F6$Fcq7$F_r$\"1f)3/(fVejFcq7$Fer$\"1g0=%)[&))H\"Fcr7$Fjr$\"1^Y[Uf?`EFcr7$F_s$\"1$o6$=ax>aFcr7$Fes$\"1+*Qd>7r5\"Fcs7$Fjs$\"1dr;^!G:E#Fcs7$F_t$\"1\\UJqXo>YFcs7$Fft$\"1W3.EZvO%*Fcs7$F[u$\"1IAOL9nF>Fdt7$F`u$\"1ZmI>mqPRFdtFduFduFduFduFduFduFdu7$Fgu$\"1w;<%RN9i#Fdt7$F\\v$\"1\"zyisB!pCFdt7$Fav$\"1\"=rO\\rFE#Fdt7$Ffv$\"1J@:[Hk\")>Fdt7$F[w$\"1k7nC7)[f\"Fdt7$F`w$\"1*o)R!)Q,d5Fdt7$Few$\"1$=(H(*QJ*R$Fcs7$Fjw$\"1Q]*yv5/$)*F\\u7$F`x$\"1eMrcH&3&oF\\u7$Fex$!1\"f$Ge4tDZF\\u7$Fjx$\"1q`&*=XdC?F^x7$F_y$!1DA2ec8,:F^x7$Fdy$\"1BS'Gb5s#>F^x-Fiy6&F[zF_zF\\zF_z" 2 279 279 279 2 0 1 0 2 9 0 4 2 1.000000 45.000000 45.000000 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 385 "\n# Output the curves to a file\nnum := 100:\ndx := 0.05:\nA:= array(1..num+1,1..2):\nB:= array(1..num+1,1..2):\n\nfor i from 1 to num+1 do\n    dum := h - (i-1)*dx:\n    A[i,1]:=dum:\n    A[i,2]:=fn0(dum):\nod:\nfor i from 1 to num+1 do\n    dum := h+Delta - (i-1)*dx:\n    B[i,1]:=dum:\n    B[i,2]:=fnm1(dum):\nod:\n\nfd:=fopen(testfile,WRITE,TEXT):\nwritedata(fd,A):\nwritedata(fd,B):\nfclose(testfile):" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 377 "\n# Integrate the curves to get the force for each v.\nnum := 200:\ndx := 0.05:\nsumn0 := h*fn0(h)/2:\nsumnm1 := h*fnm1(h+Delta)/2:\nfor i from 1 to num do\n      sumn0 := sumn0 + (h-i*dx)*fn0(h-i*dx):\n      sumnm1 := sumnm1 + (h-i*dx)*fnm1(h+Delta-i*dx):\nod:\nsumn0 := dx*(sumn0 + (h-(num+1)*dx)*fn0(h-(num+1)*dx)/2);\nsumnm1 := dx*(sumnm1 + (h-(num+1)*dx)*fnm1(h+Delta-(num+1)*dx)/2);" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#>%&sumn0G$\"+r]e67!#7" }}{PARA 11 "" 1 "" {XPPMATH 20 "6#>%'sumnm1G$\"+#=E6^\"!#7" }}}{EXCHG {PARA 0 "> " 0 "" {MPLTEXT 1 0 1 "w" }}}}{MARK "2 0 0" 0 }{VIEWOPTS 1 1 0 1 1 1803 }